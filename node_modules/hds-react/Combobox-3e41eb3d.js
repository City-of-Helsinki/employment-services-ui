import o,{useRef as e,useState as l,useMemo as t,useCallback as r}from"react";import{c as d}from"./classNames-51fcabcb.js";import{s as a}from"./style-inject.es-4a6aca40.js";import"./Icon.module-e854ac32.js";import{I as i}from"./IconAlertCircle-2c190eb1.js";import{I as m}from"./IconAngleDown-66217044.js";import c from"lodash.uniqueid";import"./base.min-dacc0a02.js";import{u as n}from"./useTheme-4d715126.js";import{u as b,b as s}from"./downshift.esm-e321a728.js";import u from"lodash.isequal";import{F as _}from"./FieldLabel-77d98fa7.js";import{useVirtual as p}from"react-virtual";import{o as g,m as x,a as v}from"./Select-1d779e6a.js";import{D as h,g as C,a as f}from"./DropdownMenu-cc760817.js";import{a as k,g as w}from"./getIsElementBlurred-bdcd45d0.js";var I={button:"Combobox-module_button__1W9PN",hidden:"Combobox-module_hidden__kvDZZ",input:"Combobox-module_input__Dcmdn",wrapper:"Combobox-module_wrapper__3kVTg",multiselect:"Combobox-module_multiselect__3vNbJ",menuItem:"Combobox-module_menuItem__ydo3T",highlighted:"Combobox-module_highlighted__12UOf",checkbox:"Combobox-module_checkbox____J7P",selected:"Combobox-module_selected__30nbv",root:"Combobox-module_root__Hs8Hg",open:"Combobox-module_open__MBBSi",angleIcon:"Combobox-module_angleIcon__10DvA",menu:"Combobox-module_menu__3jA0e",icon:"Combobox-module_icon__3tOcB",overflow:"Combobox-module_overflow__3ozqI",disabled:"Combobox-module_disabled__11PlF",virtualized:"Combobox-module_virtualized__25LXa",helperText:"Combobox-module_helperText__1qPYf",invalid:"Combobox-module_invalid__8xyxV",errorText:"Combobox-module_errorText__F29sh",invalidIcon:"Combobox-module_invalidIcon__A760K",noToggle:"Combobox-module_noToggle__1DCEd",selectedItems:"Combobox-module_selectedItems__2W0JL",adjustSpacing:"Combobox-module_adjustSpacing__3O3Pe"};a(".Combobox-module_button__1W9PN{background:none;border:none;color:inherit;cursor:pointer;font:inherit;padding:0}.Combobox-module_button__1W9PN.Combobox-module_hidden__kvDZZ,.Combobox-module_input__Dcmdn.Combobox-module_hidden__kvDZZ:not(:focus){border:0;clip:rect(0 0 0 0);clip-path:inset(50%);height:1px;margin:0 -1px -1px 0;overflow:hidden;padding:0;position:absolute;width:1px;white-space:nowrap}.Combobox-module_multiselect__3vNbJ .Combobox-module_menuItem__ydo3T.Combobox-module_highlighted__12UOf .Combobox-module_checkbox____J7P,.Combobox-module_multiselect__3vNbJ .Combobox-module_menuItem__ydo3T.Combobox-module_highlighted__12UOf.Combobox-module_selected__30nbv .Combobox-module_checkbox____J7P,.Combobox-module_wrapper__3kVTg:focus-within{box-shadow:0 0 0 var(--focus-outline-width) var(--focus-outline-color)}.Combobox-module_root__Hs8Hg{--border-width:2px;--divider-width:1px;--focus-outline-width:3px;--dropdown-height:var(--spacing-3-xl);--menu-item-height:calc(var(--dropdown-height) - var(--border-width) * 2);--icon-size:var(--spacing-m);--menu-z-index:10;--dropdown-background-default:var(--color-white);--dropdown-background-disabled:var(--color-black-10);--dropdown-border-color-default:var(--color-black-50);--dropdown-border-color-hover:var(--color-black-90);--dropdown-border-color-hover-invalid:var(--color-error-dark);--dropdown-border-color-focus:var(--color-black-90);--dropdown-border-color-invalid:var(--color-error);--dropdown-border-color-disabled:var(--color-black-10);--dropdown-color-default:var(--color-black-90);--dropdown-color-disabled:var(--color-black-40);--focus-outline-color:var(--color-coat-of-arms);--helper-color-default:var(--color-black-60);--helper-color-invalid:var(--color-error);--menu-divider-color:var(--color-black-20);--menu-item-background-default:var(--color-white);--menu-item-background-hover:var(--color-bus);--menu-item-background-selected:var(--color-white);--menu-item-background-selected-hover:var(--color-bus);--menu-item-background-disabled:var(--color-white);--menu-item-color-default:var(--color-black-90);--menu-item-color-hover:var(--color-white);--menu-item-color-selected:var(--color-black-90);--menu-item-color-selected-hover:var(--color-white);--menu-item-color-disabled:var(--color-black-40);--menu-item-icon-color-selected:var(--color-white);--menu-item-icon-color-disabled:var(--color-black-40);--multiselect-checkbox-background-selected:var(--color-bus);--multiselect-checkbox-background-disabled:var(--color-black-10);--multiselect-checkbox-border-default:var(--color-black-50);--multiselect-checkbox-border-hover:var(--color-black-90);--multiselect-checkbox-border-disabled:var(--color-black-10);--multiselect-checkbox-color-default:transparent;--multiselect-checkbox-color-selected:var(--color-white);--multiselect-checkbox-color-selected-disabled:var(--color-white);--placeholder-color:var(--color-black-60);position:relative}.Combobox-module_open__MBBSi.Combobox-module_root__Hs8Hg .Combobox-module_angleIcon__10DvA{transform:rotateX(180deg)}.Combobox-module_open__MBBSi.Combobox-module_root__Hs8Hg .Combobox-module_menu__3jA0e{display:block}.Combobox-module_wrapper__3kVTg{background-color:var(--dropdown-background-default);border:var(--border-width) solid var(--dropdown-border-color-default);box-sizing:border-box;min-height:var(--dropdown-height);position:relative;width:100%}.Combobox-module_wrapper__3kVTg:focus-within{border-color:var(--dropdown-border-color-focus)}.Combobox-module_wrapper__3kVTg:hover{border-color:var(--dropdown-border-color-hover)}.Combobox-module_wrapper__3kVTg:focus-within,.Combobox-module_wrapper__3kVTg:hover{transition:border-color 85ms ease-out}.Combobox-module_icon__3tOcB{color:var(--dropdown-color-default);display:flex;margin-right:var(--spacing-2-xs)}.Combobox-module_button__1W9PN{position:absolute;right:var(--spacing-s);top:var(--spacing-xs);transform:translateY(2px)}.Combobox-module_menu__3jA0e{border:solid var(--dropdown-border-color-focus);border-top-color:var(--menu-divider-color);border-width:var(--divider-width) var(--border-width) var(--border-width);bottom:0;display:none;left:0;list-style:none;margin:0;outline:none;padding:0;position:absolute;transform:translate(calc(var(--border-width) * -1),100%);width:100%;z-index:var(--menu-z-index)}.Combobox-module_overflow__3ozqI.Combobox-module_menu__3jA0e{overflow-y:scroll}.Combobox-module_menuItem__ydo3T{align-items:center;background-color:var(--menu-item-background-default);box-sizing:border-box;color:var(--menu-item-color-default);cursor:pointer;display:flex;font-size:var(--fontsize-body-l);justify-content:space-between;line-height:var(--lineheight-m);min-height:var(--menu-item-height);padding:var(--spacing-xs) var(--spacing-s)}.Combobox-module_highlighted__12UOf.Combobox-module_menuItem__ydo3T{background-color:var(--menu-item-background-hover);color:var(--menu-item-color-hover)}.Combobox-module_selected__30nbv.Combobox-module_menuItem__ydo3T{background-color:var(--menu-item-background-selected);color:var(--menu-item-color-selected)}.Combobox-module_highlighted__12UOf.Combobox-module_selected__30nbv.Combobox-module_menuItem__ydo3T{background-color:var(--menu-item-background-selected-hover);color:var(--menu-item-color-selected-hover)}.Combobox-module_disabled__11PlF.Combobox-module_highlighted__12UOf.Combobox-module_menuItem__ydo3T,.Combobox-module_disabled__11PlF.Combobox-module_menuItem__ydo3T{background-color:var(--menu-item-background-disabled);color:var(--menu-item-color-disabled);cursor:not-allowed}.Combobox-module_virtualized__25LXa.Combobox-module_menuItem__ydo3T{left:0;position:absolute;top:0;width:100%}.Combobox-module_helperText__1qPYf{color:var(--helper-color-default);margin-top:var(--spacing-3-xs)}.Combobox-module_disabled__11PlF .Combobox-module_wrapper__3kVTg{background-color:var(--dropdown-background-disabled);border-color:var(--dropdown-border-color-disabled);color:var(--dropdown-color-disabled)}.Combobox-module_disabled__11PlF .Combobox-module_wrapper__3kVTg,.Combobox-module_disabled__11PlF .Combobox-module_wrapper__3kVTg>*{cursor:not-allowed}.Combobox-module_disabled__11PlF .Combobox-module_angleIcon__10DvA,.Combobox-module_disabled__11PlF .Combobox-module_icon__3tOcB{color:var(--dropdown-color-disabled)}.Combobox-module_invalid__8xyxV .Combobox-module_wrapper__3kVTg{border-color:var(--dropdown-border-color-invalid)}.Combobox-module_invalid__8xyxV .Combobox-module_wrapper__3kVTg:hover{border-color:var(--dropdown-border-color-hover-invalid)}.Combobox-module_invalid__8xyxV .Combobox-module_errorText__F29sh{align-items:center;color:var(--helper-color-invalid);display:flex;margin-top:var(--spacing-3-xs)}.Combobox-module_invalid__8xyxV .Combobox-module_invalidIcon__A760K{margin-right:var(--spacing-2-xs)}.Combobox-module_multiselect__3vNbJ .Combobox-module_menuItem__ydo3T{justify-content:flex-start}.Combobox-module_multiselect__3vNbJ .Combobox-module_menuItem__ydo3T.Combobox-module_highlighted__12UOf,.Combobox-module_multiselect__3vNbJ .Combobox-module_menuItem__ydo3T.Combobox-module_highlighted__12UOf.Combobox-module_selected__30nbv,.Combobox-module_multiselect__3vNbJ .Combobox-module_menuItem__ydo3T.Combobox-module_selected__30nbv{background-color:var(--menu-item-background-default);color:var(--menu-item-color-default)}.Combobox-module_multiselect__3vNbJ .Combobox-module_menuItem__ydo3T .Combobox-module_checkbox____J7P{border:var(--spacing-4-xs) solid var(--multiselect-checkbox-border-default);box-sizing:border-box;color:var(--multiselect-checkbox-color-default);height:var(--icon-size);margin-right:var(--spacing-xs);width:var(--icon-size)}.Combobox-module_multiselect__3vNbJ .Combobox-module_menuItem__ydo3T.Combobox-module_disabled__11PlF .Combobox-module_checkbox____J7P,.Combobox-module_multiselect__3vNbJ .Combobox-module_menuItem__ydo3T.Combobox-module_highlighted__12UOf .Combobox-module_checkbox____J7P{transition:border-color 85ms ease-out}.Combobox-module_multiselect__3vNbJ .Combobox-module_menuItem__ydo3T.Combobox-module_highlighted__12UOf .Combobox-module_checkbox____J7P{border-color:var(--multiselect-checkbox-border-hover)}.Combobox-module_multiselect__3vNbJ .Combobox-module_menuItem__ydo3T.Combobox-module_selected__30nbv .Combobox-module_checkbox____J7P{background-color:var(--multiselect-checkbox-background-selected);border:0;color:var(--multiselect-checkbox-color-selected)}.Combobox-module_multiselect__3vNbJ .Combobox-module_menuItem__ydo3T.Combobox-module_disabled__11PlF .Combobox-module_checkbox____J7P{background-color:var(--multiselect-checkbox-background-disabled);border-color:var(--multiselect-checkbox-border-disabled)}.Combobox-module_multiselect__3vNbJ .Combobox-module_menuItem__ydo3T.Combobox-module_disabled__11PlF.Combobox-module_selected__30nbv .Combobox-module_checkbox____J7P{color:var(--multiselect-checkbox-color-selected-disabled)}.Combobox-module_wrapper__3kVTg{align-items:center;display:flex}.Combobox-module_button__1W9PN{color:var(--dropdown-color-default);outline:none;display:flex}.Combobox-module_icon__3tOcB{margin-left:var(--spacing-s)}.Combobox-module_input__Dcmdn{align-self:stretch;background-color:var(--input-background-default);border:none;box-sizing:border-box;color:var(--input-color-default);font-size:var(--fontsize-body-l);height:var(--menu-item-height);outline:none;padding:0 calc(var(--spacing-l) + var(--icon-size)) 0 0;-webkit-appearance:none;width:100%}.Combobox-module_input__Dcmdn:first-child{padding-left:var(--spacing-s)}.Combobox-module_input__Dcmdn.Combobox-module_noToggle__1DCEd{padding-right:var(--spacing-s)}.Combobox-module_input__Dcmdn::placeholder{color:var(--placeholder-color);opacity:1}.Combobox-module_input__Dcmdn:disabled::placeholder{color:var(--dropdown-color-disabled)}.Combobox-module_multiselect__3vNbJ .Combobox-module_wrapper__3kVTg{flex-direction:column}.Combobox-module_multiselect__3vNbJ .Combobox-module_selectedItems__2W0JL{align-self:stretch}.Combobox-module_multiselect__3vNbJ .Combobox-module_input__Dcmdn{align-self:unset;padding:0 calc(var(--spacing-l) + var(--icon-size)) 0 var(--spacing-s)}.Combobox-module_multiselect__3vNbJ .Combobox-module_input__Dcmdn.Combobox-module_noToggle__1DCEd{padding-right:var(--spacing-s)}.Combobox-module_multiselect__3vNbJ .Combobox-module_input__Dcmdn.Combobox-module_adjustSpacing__3O3Pe{margin-top:calc(var(--spacing-2-xs) * -1);padding:0 var(--spacing-s)}");const y=a=>{var y,T,O,j;const{catchEscapeKey:P,circularNavigation:N=!1,className:D,clearable:J=!0,disabled:S=!1,error:A,getA11ySelectionMessage:V=(()=>""),getA11yStatusMessage:z=(()=>""),helper:B,id:L=c("hds-combobox-"),invalid:E=!1,isOptionDisabled:F,label:M,onBlur:H=(()=>null),onFocus:R=(()=>null),optionLabelField:q="label",options:U=[],placeholder:W,required:Z,showToggleButton:K=!0,style:Y,theme:X,virtualized:G=!1,visibleOptions:Q=5,filter:$,toggleButtonAriaLabel:oo,tooltipLabel:eo,tooltipButtonLabel:lo,tooltipText:to}=a,ro=a.multiselect&&void 0!==a.value,ao=n(I.root,X),io=e(),mo=e(),co=o.useRef(),[no,bo]=l(!1),[so,uo]=l(!1),[_o,po]=l(""),go=t((()=>{var o;return($||(o=q,(e,l)=>e.filter((e=>{const t=e[o];return t?"string"==typeof t?t.toLowerCase().startsWith(l.toLowerCase()):(console.warn("Filtering failed because field ".concat(o," has a value that is not a string")),!1):(console.warn("Filtering failed because field ".concat(o," could not be found from OptionType")),!1)}))))(U,_o)}),[U,_o,$,q]),xo=p({size:go.length,parentRef:co,estimateSize:r((()=>h),[]),overscan:Q}),{activeIndex:vo,addSelectedItem:ho,getDropdownProps:Co,getSelectedItemProps:fo,removeSelectedItem:ko,reset:wo,selectedItems:Io,setActiveIndex:yo,setSelectedItems:To}=b(Object.assign(Object.assign(Object.assign({defaultActiveIndex:0,initialActiveIndex:0},a.multiselect&&{initialSelectedItems:null!==(y=a.defaultValue)&&void 0!==y?y:[]}),a.multiselect&&void 0!==a.value&&{selectedItems:null!==(T=a.value)&&void 0!==T?T:[]}),{getA11yRemovalMessage:null!==(O=a.multiselect&&a.getA11yRemovalMessage)&&void 0!==O?O:()=>"",onSelectedItemsChange:({selectedItems:o})=>a.multiselect&&"function"==typeof a.onChange&&a.onChange(o),onStateChange:o=>g(o,vo,io.current),stateReducer:(o,e)=>x(o,e,ro)})),{getItemProps:Oo,getLabelProps:jo,getMenuProps:Po,getToggleButtonProps:No,highlightedIndex:Do,isOpen:Jo,selectedItem:So,selectItem:Ao,setInputValue:Vo,getInputProps:zo,getComboboxProps:Bo}=s(Object.assign(Object.assign(Object.assign({circularNavigation:N,id:L,items:go},!1===a.multiselect&&{initialSelectedItem:null!==(j=a.defaultValue)&&void 0!==j?j:null}),!1===a.multiselect&&void 0!==a.value&&{selectedItem:a.value}),{onInputValueChange:({inputValue:o})=>po(o),getA11ySelectionMessage:V,getA11yStatusMessage:z,itemToString:o=>{var e;return o&&null!==(e=o[q])&&void 0!==e?e:""},onHighlightedIndexChange:({highlightedIndex:o})=>xo.scrollToIndex(o),onSelectedItemChange:({selectedItem:o})=>!1===a.multiselect&&"function"==typeof a.onChange&&a.onChange(o),onStateChange({type:o,selectedItem:e}){const{InputBlur:l,InputKeyDownEnter:t,ItemClick:r}=s.stateChangeTypes;(o===l||o===t||o===r)&&a.multiselect&&e&&(C(Io,e)?To(Io.filter((o=>!u(o,e)))):ho(e),Ao(null))},stateReducer(o,{type:e,changes:l}){const{ItemClick:t,InputBlur:r}=s.stateChangeTypes,{selectedItem:d,inputValue:i}=l;return!a.multiselect&&d&&d[q]!==i?Object.assign(Object.assign({},l),{selectedItem:null}):e!==r||a.multiselect||d?e===t&&a.multiselect?Object.assign(Object.assign({},l),{isOpen:o.isOpen,highlightedIndex:o.highlightedIndex,inputValue:""}):l:Object.assign(Object.assign({},l),{inputValue:""})}})),Lo=o=>e=>{so||o(e)};a.multiselect||Co({},{suppressRefError:!0});const Eo=!a.multiselect||Jo||!Jo&&0===Io.length,Fo="".concat(jo().id).concat(A?" ".concat(L,"-error"):"").concat(B?" ".concat(L,"-helper"):""," ").concat(zo().id);return o.createElement("div",{className:d(I.root,E&&I.invalid,S&&I.disabled,Jo&&I.open,a.multiselect&&I.multiselect,ao,D),style:Y},M&&o.createElement(_,Object.assign({label:M,required:Z},jo(),{tooltipLabel:eo,tooltipButtonLabel:lo,tooltipText:to})),o.createElement("div",{onFocus:Lo((o=>{w(o)&&(bo(!0),R())})),onBlur:Lo((o=>{k(o)&&(bo(!1),H())})),onClick:o=>{const e=io.current;e!==o.target&&(null==e?void 0:e.contains(o.target))||mo.current&&mo.current.focus()},className:d(I.wrapper),ref:Bo().ref},a.multiselect&&Io.length>0&&o.createElement(v,{activeIndex:vo,className:I.selectedItems,clearable:J,clearButtonAriaLabel:a.clearButtonAriaLabel,dropdownId:L,getSelectedItemProps:fo,hideItems:!no,onClear:()=>{wo(),Vo("")},onRemove:ko,optionLabelField:q,removeButtonAriaLabel:a.selectedItemRemoveButtonAriaLabel,selectedItems:Io,selectedItemSrLabel:a.selectedItemSrLabel,selectedItemsContainerRef:io,setActiveIndex:yo,toggleButtonHidden:!K}),!1===a.multiselect&&a.icon&&o.createElement("span",{className:I.icon,"aria-hidden":!0},a.icon),o.createElement("input",Object.assign({},zo(Object.assign(Object.assign(Object.assign({},E&&{"aria-invalid":!0}),a.multiselect&&Object.assign({},Co({onKeyDown:o=>{if(P&&"Escape"===o.key&&o.stopPropagation()," "===o.key&&(o.preventDefault(),Do>-1)){const o=go[Do];C(Io,e=o)?To(Io.filter((o=>!u(o,e)))):ho(e)}var e;!Jo||"Backspace"!==o.key&&"ArrowLeft"!==o.key||(o.nativeEvent.preventDownshiftDefault=!0)},ref:mo}))),{type:"text",disabled:S,required:Z,role:Bo().role,"aria-expanded":Bo()["aria-expanded"],"aria-haspopup":Bo()["aria-haspopup"],"aria-owns":Bo()["aria-owns"],"aria-labelledby":Fo})),{placeholder:W,className:d(I.input,!Eo&&I.hidden,!K&&I.noToggle,no&&Io.length>0&&I.adjustSpacing),autoCorrect:"off",autoComplete:"off"})),o.createElement("button",Object.assign({type:"button"},No(Object.assign({disabled:S,className:d(I.button,!K&&I.hidden),"aria-label":"".concat(M,": ").concat(oo)},E&&{"aria-invalid":!0}))),o.createElement(m,{className:I.angleIcon,"aria-hidden":!0})),o.createElement(f,{getItemProps:(o,e,l,t,r)=>Oo(Object.assign({item:o,index:e,disabled:t,className:d(I.menuItem,Do===e&&I.highlighted,l&&I.selected,t&&I.disabled,G&&I.virtualized),onMouseDown:()=>{uo(!0)},onClick:()=>{uo(!1)}},r&&{style:{transform:"translateY(".concat(r.start,"px")},ref:r.measureRef})),isOptionDisabled:F,menuProps:Po(Object.assign(Object.assign(Object.assign({},a.multiselect&&{"aria-multiselectable":!0}),Z&&{"aria-required":!0}),{style:{maxHeight:h*Q},ref:co,onMouseLeave:o=>{o.nativeEvent.preventDownshiftDefault=!0}})),menuStyles:I,multiselect:a.multiselect,open:Jo,optionLabelField:q,options:go,selectedItem:So,selectedItems:Io,virtualizer:G&&xo,visibleOptions:Q})),E&&A&&o.createElement("div",{id:"".concat(L,"-error"),className:I.errorText,"aria-hidden":!0},o.createElement(i,{className:I.invalidIcon}),A),B&&o.createElement("div",{id:"".concat(L,"-helper"),className:I.helperText,"aria-hidden":!0},B))};y.defaultProps={multiselect:!1};export{y as C};
